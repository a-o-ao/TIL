# Amazon Route53

## レコードタイプ

| レコードタイプ       | 説明                                                                                     | 主な用途                                                   |
|----------------------|------------------------------------------------------------------------------------------|------------------------------------------------------------|
| **Aレコード**        | ドメイン名をIPv4アドレスにマッピングします。                                                | ウェブサイトやサーバーのIPアドレス指定                       |
| **AAAAレコード**     | ドメイン名をIPv6アドレスにマッピングします。                                                | IPv6対応ウェブサイトやサーバーのIPアドレス指定               |
| **CNAMEレコード**    | ドメイン名を別のドメイン名にマッピングします。                                               | サブドメインを別名にリダイレクト（www.example.com → example.com） |
| **MXレコード**       | メールサーバーを指定します。                                                              | ドメイン宛のメール配送先指定                                 |
| **TXTレコード**      | 任意のテキスト情報を保持します。                                                          | SPF設定、ドメイン所有証明、DKIMなど                          |
| **NSレコード**       | ドメインを管理するネームサーバーを指定します。                                              | DNSサーバーの委任設定                                        |
| **SRVレコード**      | 特定のサービスを実行しているホストを指定します。                                            | SIPサーバーやLDAPサービスの指定                               |
| **PTRレコード**      | IPアドレスをドメイン名に逆引きします。                                                      | リバースDNSルックアップ                                      |
| **SOAレコード**      | ゾーン情報を保持し、管理者やシリアル番号、更新間隔を記録します。                             | DNSゾーンの基本情報管理                                      |
| **CAAレコード**      | SSL/TLS証明書発行を許可する認証局を指定します。                                             | 不正な証明書発行防止                                         |
| **Aliasレコード**    | AWSリソース（S3、CloudFront、ELBなど）にエイリアスとしてマッピングできます。                | AWSサービスとカスタムドメインの統合                          |

### エイリアスレコード

エイリアスレコード（Aliasレコード）は、AWSのRoute 53で使用できる特別なレコードタイプで、特定のAWSリソースに名前解決をマッピングするために使われます。
通常のCNAMEレコードとは異なり、ルートドメイン（zone apex）にも使用できる点が特徴です。

#### エイリアスレコードの特徴
- AWSリソースを直接指す
  - S3バケット（ウェブホスティング対応）
  - CloudFrontディストリビューション
  - Elastic Load Balancer（ALB、NLB）
  - API Gatewayカスタムドメイン
  - VPCエンドポイント
  - 他のRoute 53レコード
- DNSクエリのコストがかからない
  - 通常のRoute 53のクエリ料金が発生しないためコスト効率が良い。
- ルートドメイン（Zone Apex）にも対応
  - 例：example.com → CloudFrontやALB
  - CNAMEではルートドメインに指定できないが、エイリアスレコードなら可能。
- 動的IP変更に対応
  - ELBやCloudFrontのIPアドレスが変わっても自動更新されるため、運用が容易。

## ルーティングタイプ

| ルーティングタイプ      | 概要                                                                                   | ユースケース                                                                                                                        |
|-------------------|----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| シンプルルーティング    | 単一のリソースにトラフィックをルーティングする最も基本的なタイプ。                                      | 企業公式サイトが単一のEC2インスタンスで稼働している場合に、そのサーバーにすべてのユーザリクエストを送る。                                |
| フェイルオーバールーティング | プライマリリソースが障害で応答しない場合に、バックアップリソースへルーティングを切り替える。                    | メインのWebサーバーが障害で応答しなくなった際、自動的に別リージョンのバックアップサーバーに切り替え、サービスダウンを防ぐ。               |
| レイテンシールーティング  | ユーザから最も遅延が少ないリージョンのリソースにルーティングする。                                      | 世界中にユーザがいる動画配信サービスで、ユーザに最も近いリージョン（例えば東京リージョンやオレゴンリージョン）から映像を配信し、快適さを確保する。 |
| 加重ルーティング        | 複数のリソースにトラフィックを指定した割合で振り分ける。                                            | 新しいバージョンのアプリケーションを段階的にリリースする際、まずは10%のトラフィックを新バージョンに向け、残り90%は旧バージョンに送る。      |
| 地理的ルーティング      | ユーザの地理的位置に基づいてリクエストを特定のリソースにルーティングする。                                | 日本のユーザには東京リージョンのサーバー、アメリカのユーザにはバージニアリージョンのサーバーにリクエストを送ることで、各地域に最適化されたサービスを提供する。 |
| 地理プロキシルーティング  | ユーザのIPアドレスの場所に基づき、柔軟にルーティングポリシーを適用できる。                              | 特定の国からのアクセスのみを許可するサイトで、不正な国からのアクセスをブロックし、許可された地域のサーバーへのみルーティングする。          |
| マルチバリュールーティング | 複数のヘルシーなレコードにトラフィックを振り分ける。                                            | ショッピングサイトで複数のWebサーバーが稼働している場合に、ヘルスチェックで異常がないサーバーへトラフィックを均等に振り分けることで高可用性を実現する。 |

### Route 53 の DNSフェイルオーバー

DNSフェイルオーバーとは、ドメインネームシステム（DNS）を使用して、あるリソース（例えばサーバーやサービス）の障害が発生した場合に、予備のリソースへ自動的にトラフィックを切り替える仕組みです。これにより、システムの可用性を向上させ、ダウンタイムを最小限に抑えることができます。

Webに限定したものではない。以下のリソースをフェイルオーバー可能

- EC2インスタンス: ウェブサーバー以外のバックエンドサービスやアプリケーションサーバーが稼働しているEC2インスタンスに対してもフェイルオーバーを設定できます。

- データベース: Route 53でデータベースのリーダーとライター間でフェイルオーバーを構成することも可能です（例えば、RDSのリーダー/ライター構成の場合）。

- その他のAWSリソース: EC2以外でも、AWS内のさまざまなリソース（例えば、ELBなど）に対してもフェイルオーバーを設定できます

## Amazon Route 53 Resolver

Amazon Route 53 Resolverは、VPC内でのDNSクエリの解決を提供するAWSのサービスです。これにより、AWS環境内やオンプレミス環境とAWS間でDNS解決を行うことができます。具体的には、VPC内のリソースや外部ネットワーク（オンプレミス）からDNSクエリを送受信するために使用されます。

### インバウンドエンドポイント:
- オンプレミスや外部ネットワークから、AWS VPC内のリソース（例えば、EC2インスタンスやRDS）に対するDNSクエリを受け取ることができます。
- これにより、オンプレミスのDNSサーバーがVPC内のリソースを解決できるようになります。

### アウトバウンドエンドポイント:
- AWS VPC内のリソースが、VPC外（オンプレミスのDNSサーバーやインターネット上のDNSサーバーなど）に対してDNSクエリを送信するために使用します。
- これにより、AWSのリソースが外部のDNSサーバーにアクセスできるようになります。

### ハイブリッドDNS:
- Route 53 Resolverは、オンプレミス環境とAWSクラウド環境の間でDNS解決を統一的に行えるため、ハイブリッドクラウド構成でのDNS管理を簡素化します。

### DNSフォワーディング:
- 特定のDNSクエリを別のDNSサーバーに転送するために設定できるフォワーディングルールを定義できます。
- 例えば、VPC内からのDNSクエリを特定のDNSサーバーに転送することで、外部のDNS解決を利用することができます。

### セキュリティ:
- ルールベースでDNSリクエストを制御し、特定のリソースやIPアドレスのみがDNSクエリを送受信できるようにすることができます。

