# セキュリティ

## セキュリティグループとネットワークACLの違い

セキュリティグループはインスタンス単位でステートフルに設定されるのに対し、
ネットワークACLはサブネット単位でステートレスに設定されるため、それぞれの使用ケースに応じて使い分けが重要です。

| 特徴                         | セキュリティグループ (Security Group)                         | ネットワークACL (Network ACL)                                  |
|----------------------------|----------------------------------------------------------|------------------------------------------------------------|
| **適用範囲**                  | インスタンス単位で適用                                        | サブネット単位で適用                                           |
| **ステートフル/ステートレス**   | ステートフル（インバウンド/アウトバウンドが自動的にトラッキング） | ステートレス（インバウンドとアウトバウンドを別々に設定）        |
| **ルールの方向性**             | インバウンドとアウトバウンドのルールを別々に設定                | インバウンドとアウトバウンドの両方で個別に許可/拒否のルールを設定   |
| **ルールの設定**               | 許可ルールのみ設定可能（拒否ルールは設定不可）                   | 許可と拒否のルール両方を設定可能                                 |
| **デフォルトの挙動**           | デフォルトで全て拒否（必要なルールを追加する必要がある）            | デフォルトで全て許可（必要なルールを追加して制限する）             |
| **処理順序**                  | ルールは一度のパケットで評価され、最初に一致したルールが適用         | ルールはリスト順に評価され、最初に一致したルールが適用             |
| **関連付け可能リソース**       | EC2インスタンス、ENI（Elastic Network Interface）など               | VPC内の全てのサブネット                                           |
| **適用タイミング**             | インスタンス起動時またはネットワークインターフェース作成時に適用       | サブネット作成時に適用                                           |


## ネットワークACLとウェブACLの違い

| 特徴              | ネットワークACL（Network ACL）                   | ウェブACL（Web ACL）                           |
| ----------------- | ----------------------------------------------- | --------------------------------------------- |
| **適用範囲**      | サブネット間やインターネットとの通信の制御     | WebアプリケーションへのHTTP/HTTPSリクエストの制御 |
| **動作レイヤー**  | ネットワーク層（Layer 3）                      | アプリケーション層（Layer 7）                |
| **使用対象**      | VPC内のインスタンス間やインターネットとの通信 | WebアプリケーションやAPIへのアクセス管理     |
| **状態管理**      | ステートレス                                    | ステートフル                                 |
| **管理単位**      | サブネット単位                                  | AWS WAFのWebACL単位                          |
