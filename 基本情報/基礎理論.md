# 基礎理論

- [2進数](#2進数)
- [16進数](#16進数)
- [表現できる数値範囲](#表現できる数値範囲)
- [マイナス表現](#マイナス表現)
- [固定小数と浮動小数](#固定小数と浮動小数)
- [誤差](#数値計算における誤差の種類)

## 2進数

### 2進数→10進数

- 小数部分は 1/2, 1/4, 1/8, 1/16... していく

```
  1     0     1   .   1     0     1
[2²] [2¹] [2⁰]     [2⁻¹][2⁻²][2⁻³]
  4  +  0  + 1   +   0.5 + 0 + 0.125  = 5.625
```

#### オール1の場合の計算方法

- 一番左の数 + (一番左の数 - 1)

```
1  1  1  1  1  1  1
↓
64 32 16 8  4  2  1

→64+(64-1)
```

### 10進数→2進数

#### 整数部

- 2で割っていく
- 余りを下から読む

例：13（10進数）
```
| 割る数 | 商（÷2の結果） | 余り |
|--------|----------------|------|
| 13 ÷ 2 | 6              | 1    |
| 6 ÷ 2  | 3              | 0    |
| 3 ÷ 2  | 1              | 1    |
| 1 ÷ 2  | 0              | 1    |

➡️ 下から余りを読むと：**1101（2進数）**
```

#### 小数部

- 小数に2をかける
- 上から整数部分を読む

例：0.625（10進数）
```
| 値         | ×2の結果 | 整数部分 | 小数部分（次に使う） |
|------------|-----------|-----------|------------------------|
| 0.625 × 2  | 1.25      | 1         | 0.25                   |
| 0.25 × 2   | 0.5       | 0         | 0.5                    |
| 0.5 × 2    | 1.0       | 1         | 0.0                    |

➡️ 上から整数部分を読むと：**0.101（2進数）**
```

※無限小数になる場合がある
- 0.05


### 2進数の乗算

いったん10進数に変換して乗算し、2進数に戻す


## 16進数

### 16進数→10進数

```
// 例)20C0A
2        0      C      0    A
16⁴      16³    16²   16¹   16⁰
x65536  x4096  x256   x16   x1
```

| 桁の値 | 16進 → 10進 | かける重み（16ⁿ） | 計算式              | 結果     |
|--------|--------------|-------------------|----------------------|----------|
| 2      | 2            | 16⁴ = 65536       | 2 × 65536            | 131072   |
| 0      | 0            | 16³ = 4096        | 0 × 4096             | 0        |
| C      | 12           | 16² = 256         | 12 × 256             | 3072     |
| 0      | 0            | 16¹ = 16          | 0 × 16               | 0        |
| A      | 10           | 16⁰ = 1           | 10 × 1               | 10       |
|        |              |                   | **合計**              | **134154** |

※1111 = F

### 10進数→16進数

- 16で割っていく
- 余りを下から読む

 例) 778（10進数）を16進数に変換する手順

| 割る数 | 商（結果） | 余り | 16進数での余り表記 |
|--------|-------------|------|----------------------|
| 778 ÷ 16 | 48         | 10   | A                    |
| 48 ÷ 16  | 3          | 0    | 0                    |
| 3 ÷ 16   | 0          | 3    | 3                    |

➤ 下から余りを並べる（逆順） -> 30A

## 表現できる数値範囲

- nビットで表現できる文字の種類 -> 2ⁿ種類

## マイナス表現

コンピュータは引き算が苦手なので、マイナスの値を加算する必要がある。

### 2進数でのマイナス（負の数）表現の主な方法

| 方法名             | 特徴                                         | 現在の使用状況             |
|--------------------|----------------------------------------------|----------------------------|
| 符号・絶対値表現   | 最上位ビットで符号（0:正, 1:負）を示す。値はそのまま。<br>例：+5 = 00000101, -5 = 10000101 | 学習用には使われるが実用では非推奨 |
| 1の補数表現        | 正の数の各ビットを反転（0↔1）<br>例：+5 = 00000101 → -5 = 11111010 | 古い方式（ゼロが2通り存在）     |
| **2の補数表現**    | 1の補数に1を加える → 負の数の表現に使う<br>例：+5 = 00000101 → -5 = 11111011 | ✅ 現在のコンピュータで主流    |

### 2の補数でのマイナス表現

- 最上位ビット（MSB）が 0 の場合 → 正の数, 1 の場合 → 負の数
- 負の数は「対応する正の数の2の補数」で表す

#### 2の補数の変換ステップ（例：-5 を 8ビットで表す）

```
ステップ1：+5 を 2進数にする（8ビットで先頭を0埋めする）
00000101

ステップ2：ビット反転（1の補数）
11111010

ステップ3：1を足す（2の補数）
11111011 → ✅ -5 の2の補数表現（8ビット）
```

```
// 4ビットの 2の補数 で 「-2」を表現

1. 2 -> 0010
2. 1101 (0010を反転)
3. 1110 (1足す)
```

### 範囲（nビットの2の補数）

- 2の補数での表現範囲の公式

```
-2ⁿ⁻¹ ～ 2ⁿ⁻¹ - 1
```

| ビット数 (n) | 表せる範囲（10進数）           | 最小値（-2ⁿ⁻¹） | 最大値（2ⁿ⁻¹ - 1） |
|--------------|-------------------------------|------------------|--------------------|
| 4ビット       | -8 ～ +7                      | -8               | +7                 |
| 8ビット       | -128 ～ +127                  | -128             | +127               |
| 16ビット      | -32,768 ～ +32,767            | -32,768          | +32,767            |
| 32ビット      | -2,147,483,648 ～ +2,147,483,647 | -2³¹             | +2³¹ - 1           |
| 64ビット      | -9,223,372,036,854,775,808 ～ +9,223,372,036,854,775,807 | -2⁶³ | +2⁶³ - 1         |

※ ***補足***

オール1の場合は常に -1 になる

| ビット幅 | オール1のビット列              | 2の補数としての10進値 | 符号なし（unsigned）としての値 |
|----------|----------------------------------|------------------------|-------------------------------|
| 4ビット  | 1111                             | -1                     | 15                            |
| 8ビット  | 11111111                         | -1                     | 255                           |
| 16ビット | 1111111111111111                 | -1                     | 65,535                        |

## 固定小数と浮動小数

### 固定小数

小数点の位置があらかじめ決まっている数の表現方法

```
例）110101を10進数に変換せよ。ただし後ろから2桁を小数とする。
→1101.01
→13.25
```

### 浮動小数

指数を用いて小数点の位置を変化させながら
最小限の情報量で数値を取り扱う

小数点の位置を値に応じて自由に動かせる数の表現方法です。

```
α = 仮数 × 基数^指数
α = f x r^e
```

| 用語   | 意味・役割                                                                 |
|--------|-----------------------------------------------------------------------------|
| 仮数   | 実際の数値の有効桁部分。例：1.23 × 10⁴ の「1.23」                          |
| 基数   | 何進法かを示す基準値。**10進数なら「10」、2進数なら「2」**                      |
| 指数   | 小数点をどれだけ動かすかを示す数。例：10⁴ の「4」は小数点を右に4桁動かす     |


#### 正規化

- 整数部は0，小数部の最初は0以外の数字になるように桁をずらす
- 値が変わらないように掛け算をする
```
// まずは10進数で考える

1.23    = 0.123 x 10¹
123.456 = 0.123456 x 10³
0.00123 = 0.123 x 10⁻²
```

## 数値計算における誤差の種類

| 種類         | 主な原因・特徴          | 例や補足       |
|--------------|----------------------------------------------------------------------------------|----------------------------------------------------------|
| 丸め誤差     | 有限桁数で表現するために、最も近い数値に丸める(切り捨て、切り上げ、四捨五入など)ことで生じる誤差                 | 0.1（無限小数）を2進数で表せない → 近似値になる         |
| 打切り誤差   | 有限の桁数で途中で打ち切ることで生じる誤差（丸めずに切り捨て）                 | sin(x) の級数展開を途中でやめると誤差が生じる           |
| 桁落ち       | 近い数同士の引き算で有効数字が減る（前方の桁が消える）                          | 1.2345 - 1.2344 = 0.0001（有効桁が極端に減る）           |
| 情報落ち     | 非常に大きな数と非常に小さな数の足し算で、小さな値が無視される<br>※数多くの数値の加算を行う場合，絶対値の小さなものから順番に計算すると情報落ちを防げる   | 10⁸ + 1.23 → 10⁸ になる（1.23 が消える）                |
| オーバーフロー | 表現可能な最大値を超える（正方向にあふれる）                                 | floatで 1.0e+308 を超えると「∞」になる                  |
| アンダーフロー | 非ゼロの極小値が表現できず 0 になる（小さすぎて消える）                        | floatで 1.0e-324 未満が 0 になる                         |

